# 新标签页覆盖功能测试指南

## 快速测试指南

### 1. 构建扩展

```bash
cd apps/extension
pnpm build
```

这将在 `apps/extension/dist/` 中创建启用了新标签页覆盖的生产构建。

### 2. 在 Chrome 中加载扩展

1. 打开 Chrome 并访问 `chrome://extensions/`
2. 启用"开发者模式"（右上角的开关）
3. 点击"加载已解压的扩展程序"
4. 选择 `apps/extension/dist` 文件夹
5. 扩展现在应该已加载

### 3. 测试新标签页覆盖

1. **打开新标签页**（`Cmd+T` 或 `Ctrl+T`）
2. **预期结果**：应该看到 Aura 仪表板，而不是 Chrome 的默认新标签页
3. **验证**：
   - ✅ Aura 仪表板加载
   - ✅ 工作区和集合可见
   - ✅ 搜索功能正常（`Cmd+K` 或 `Ctrl+K`）
   - ✅ 主题切换正常
   - ✅ 所有仪表板功能按预期工作

### 4. 测试仪表板仍然正常工作

1. 点击工具栏中的 Aura 扩展图标
2. 在弹出窗口中点击"打开仪表板"
3. **预期结果**：仪表板在新标签页中打开
4. **验证**：新标签页和仪表板标签页显示相同的界面

### 5. 测试开发模式

对于开发，可以使用开发服务器进行测试：

```bash
cd apps/extension
pnpm dev
```

然后：
1. 从 `apps/extension/dist` 加载扩展（由开发服务器生成）
2. 打开新标签页
3. 当你进行更改时，新标签页应该热重载

**注意**：在开发模式下，你可能会在控制台中看到 `http://localhost:5173` URL，这是正常的。

## 故障排除

### 新标签页显示空白页

**可能原因**：
- 扩展未正确加载
- 构建失败或不完整
- 控制台错误（检查 DevTools）

**解决方案**：
1. 检查 `chrome://extensions/` 是否有错误
2. 重新构建扩展：`pnpm build`
3. 重新加载扩展
4. 检查浏览器控制台错误（F12）

### 新标签页显示 Chrome 的默认页面

**可能原因**：
- 另一个扩展正在覆盖新标签页
- Manifest 未正确配置
- 扩展未启用

**解决方案**：
1. 检查是否有其他扩展正在覆盖新标签页
2. 禁用其他新标签页扩展
3. 验证 `manifest.json` 包含 `chrome_url_overrides.newtab`
4. 重新加载扩展

### 新标签页上的功能不工作

**可能原因**：
- JavaScript 错误
- 缺少权限
- 构建问题

**解决方案**：
1. 打开 DevTools（F12）并检查控制台标签
2. 验证所有资源正确加载（网络标签）
3. 检查 localStorage/IndexedDB 是否可访问
4. 重新构建并重新加载扩展

## 验证清单

- [ ] 新标签页打开 Aura 仪表板
- [ ] 搜索功能正常（`Cmd+K`）
- [ ] 主题切换正常
- [ ] 工作区可见
- [ ] 集合可见
- [ ] 标签页可以打开
- [ ] 认证对话框正常（如果未登录）
- [ ] 同步功能正常（如果已登录）
- [ ] 离线模式正常（断开网络）
- [ ] 无控制台错误
- [ ] 性能良好（加载快速）

## 开发测试

### 使用本地 API 测试

1. 启动本地 API：
   ```bash
   pnpm dev:api
   ```

2. 启动扩展开发服务器：
   ```bash
   pnpm dev
   ```

3. 从 `dist/` 加载扩展
4. 打开新标签页
5. 测试认证和同步功能

### 测试离线

1. 打开新标签页（Aura 仪表板加载）
2. 打开 DevTools → 网络标签
3. 将限速设置为"离线"
4. 刷新页面
5. **预期**：仪表板仍然使用缓存数据工作

## 性能测试

### 测量加载时间

1. 打开 DevTools → 性能标签
2. 开始录制
3. 打开新标签页
4. 停止录制
5. **预期**：仪表板在 < 1 秒内加载

### 检查包大小

```bash
cd apps/extension
pnpm build
```

检查输出的包大小：
- `newtab.html` 应该 < 1 KB
- 共享的 JS 包应该进行代码分割
- CSS 应该被优化

## 测试后的后续步骤

如果所有测试通过：
1. ✅ 功能已准备好使用
2. 考虑添加用户设置来切换此功能
3. 添加分析以跟踪新标签页使用情况（可选）
4. 收集用户反馈

如果测试失败：
1. 检查控制台错误
2. 验证构建输出
3. 检查 manifest 配置
4. 检查与其他扩展的冲突

